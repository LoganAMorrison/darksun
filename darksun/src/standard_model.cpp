//
// Created by Logan Morrison on 2/7/20.
//

#include "darksun/standard_model.hpp"
#include <vector>
#include <cmath>
#include <boost/math/interpolators/cubic_b_spline.hpp>

namespace darksun{

constexpr double _sm_log_temperature_min = -4.5;
constexpr double _sm_log_temperature_max = 4.0;
constexpr double _sm_log_temperature_step = 0.025;


// Interpolation data for Sqrt[g_star]
static const std::vector<double> _data_sm_sqrt_gstars{
        2.141289997868463, 2.141641239600222, 2.1421099848988665,
        2.1423743816414347, 2.143130008012523, 2.144764339392538, 2.1478799359327403, 2.153398739889584,
        2.160750058048653,
        2.1689613911348715, 2.180160138904919, 2.1962117262554206, 2.21692958201033, 2.24254151586023,
        2.273669819788228, 2.310986313230254, 2.3545702411737506, 2.404790106260388,
        2.4614499278151882, 2.524635068320252, 2.59387, 2.669149116920886, 2.7491480369692916, 2.8337351026484665,
        2.9193263461693046, 3.003047262981907, 3.082637683280093, 3.154873274020067,
        3.2197721598249207, 3.277109327543051, 3.324389760193869, 3.3585530467925744, 3.381070287315915,
        3.390365806392904, 3.392520021653115, 3.3935581681999984, 3.392070064207229,
        3.3884837204889333, 3.3833098959473715, 3.3770724967390504, 3.3701600913784824, 3.362910614940577,
        3.3559998830690314, 3.3503255321275707, 3.3455599716392177, 3.342062527991385,
        3.338670057114478, 3.3339343961380514, 3.329069964436909, 3.324891206496724, 3.3211499642706412,
        3.3178337184222757, 3.31504997924517, 3.3131037469563824, 3.3113900091178534,
        3.309290625724426, 3.3071499894038823, 3.305118744624142, 3.3031600023142444, 3.3012462505312565, 3.2995,
        3.297967508466774, 3.2968500204808375, 3.2964543951763505, 3.296510029620001,
        3.297008762366399, 3.2974699902875244, 3.297281859445965, 3.2968299847495746, 3.296327494735112,
        3.2956800041831307, 3.29482436777356, 3.293879979861495, 3.292894359478376,
        3.292019993962855, 3.291453126194753, 3.2911100058200073, 3.290979380500434, 3.291040002875626,
        3.291279997353626, 3.2916599943550726, 3.29220375108024, 3.292710005860072,
        3.2929350041172745, 3.2930300006077853, 3.2930731257995096, 3.2930400011235297, 3.2929512495626585,
        3.2927499973479586, 3.2923556209013425, 3.2918599944748372, 3.2912968693404805,
        3.2907599952104065, 3.290322497780271, 3.290080000608429, 3.290020628746942, 3.290540006356789,
        3.292180626526222, 3.2944899968939008, 3.297181878865957, 3.3003, 3.303301747380361,
        3.3076598717440273, 3.314894760073705, 3.324320726317179, 3.335240719515547, 3.349209522168081, 3.3671145918686,
        3.3902609609837366, 3.420821004719461, 3.457079776037518,
        3.49890530832402, 3.54372090890585, 3.589140811061479, 3.6344603954889956, 3.6784570671195094,
        3.720299001616512, 3.758177309040611, 3.7938006389548744, 3.8284426491916834,
        3.861599583609212, 3.8931969021713444, 3.9232205549403876, 3.9515610464133837, 3.9784301950276855,
        4.003959490712717, 4.028309621750078, 4.05174021925105, 4.074550183025175,
        4.097100327817213, 4.119860231686627, 4.143450100893565, 4.168540246354692, 4.19654993439492, 4.230929793700569,
        4.275960254339784, 4.33495033569635, 4.405270214635249,
        4.482479901845056, 4.568809784880339, 4.67508, 4.796808796884228, 5.002653119965267, 5.411365122564551,
        5.917438769299523, 6.478302290230584, 7.179788359703159, 7.856429144968539,
        8.350952119320674, 8.564474529235284, 8.543100549869138, 8.41707118418172, 8.298388149814915, 8.232150326290455,
        8.214369993909546, 8.22516910148682, 8.24773937226796,
        8.273020828696117, 8.297960445243808, 8.322710382016718, 8.348479657286694, 8.376419150066134,
        8.407119040286302, 8.440620649899305, 8.476440273693164, 8.513870787361697,
        8.552009395197521, 8.589768983891233, 8.626480291301597, 8.661619376988595, 8.694900325066234, 8.72643012840514,
        8.756489466476689, 8.785789937649934, 8.81486984584274,
        8.84423014378294, 8.874190155626446, 8.904810090448695, 8.93592996231311, 8.967199354899376, 8.99818,
        9.028371810288613, 9.057319325098895, 9.08465085983787, 9.110068455819464,
        9.133360413774337, 9.154419397963792, 9.173229107047057, 9.1898505436927, 9.20435916392654, 9.216919932920398,
        9.227689916575413, 9.236850169705635, 9.244589944047, 9.251090052580713,
        9.256529771920547, 9.261019899345381, 9.26478399575956, 9.26791005107098, 9.270478773838388, 9.272599975171541,
        9.274399958939908, 9.275909958633646, 9.277190608185332,
        9.278280007572494, 9.27922874950549, 9.280059987588558, 9.280802495180462, 9.281490005351355, 9.282147508893267,
        9.28283000687285, 9.283564993863886, 9.284459981876887,
        9.28557623771749, 9.287079990771886, 9.289083716821338, 9.291809947238562, 9.295433092478296, 9.300209993449117,
        9.306395870743073, 9.31417, 9.323730643874415, 9.335279699076857,
        9.34891047879047, 9.364701260889584, 9.382680356045128, 9.402849358492148, 9.425148822257064, 9.449540889596031,
        9.475971140037373, 9.504369830711155, 9.534709737251081,
        9.566930667901762, 9.600959724507804, 9.636720323191923, 9.674061033635413, 9.712799028574947, 9.75271133464772,
        9.793480742350749, 9.834748222794437, 9.876099469716339,
        9.917120927003229, 9.957360756626844, 9.996390715105953, 10.03380027179466, 10.069300712701187,
        10.102499492181899, 10.133300279847873, 10.161400217022496, 10.186900352022574,
        10.209800216138225, 10.229998975856804, 10.24770015602039, 10.262999969576162, 10.276199935539697,
        10.287400049705742, 10.29680004431801, 10.304700020958572, 10.311199992925626,
        10.316499989148781, 10.3208, 10.324300186325504, 10.326999942569323, 10.329200062947745, 10.330900110768116,
        10.332200021143153, 10.333199973327032, 10.333999964695455,
        10.334600016913614, 10.335000014552058, 10.335299998559291, 10.335499981553205, 10.335700003023437,
        10.33579999960545, 10.33579999885358, 10.335900000905022, 10.335900000411378,
        10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.33590000090692,
        10.33579999973006, 10.3358, 10.3358, 10.3358, 10.3358, 10.3358, 10.3358, 10.3358,
        10.3358, 10.3358, 10.3358, 10.3358, 10.3358, 10.3358, 10.3358, 10.335799999457308, 10.335799997889367,
        10.33590000062198, 10.33590000050333, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359,
        10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359,
        10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359,
        10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359, 10.3359};

// Interpolation data for h_eff
static const std::vector<double> _data_sm_heffs{3.9387999991430975, 3.938857495057558, 3.939029992374593,
        3.9394199992353753,
        3.9400200023255874, 3.9405506072828556, 3.941929968118308, 3.94494124979267, 3.949710043121497,
        3.956211989444685, 3.965680111137088, 3.978887355858084, 3.9971896164213354, 4.021680276199021,
        4.053919806380377, 4.0952788395341555, 4.147420297837358, 4.211901996248075,
        4.2904098962085415, 4.384668913783994, 4.49612, 4.626378131871737, 4.776646154015349, 4.9488549981466,
        5.142435352943627, 5.358423489711211, 5.593932612798939, 5.847619763418146,
        6.115889630322266, 6.396207697398362, 6.6840483271625795, 6.976314066429208, 7.266185734065843,
        7.546111244160505, 7.815192311303785, 8.069970597690702, 8.310574243364147,
        8.535986941998477, 8.746183651945367, 8.940613503447796, 9.119837792813225, 9.283908135499344, 9.43380271729935,
        9.569917263121496, 9.694050888018502, 9.808173156742438,
        9.912168428652636, 10.006323138799969, 10.091400653807613, 10.168033928282645, 10.236900653727062,
        10.298569371753427, 10.354000501799236, 10.404287602839673, 10.449599772715418,
        10.490381192332134, 10.526900177058348, 10.5594688453592, 10.58839996718056, 10.613999995164312, 10.6366,
        10.656493465381608, 10.674099602936625, 10.689756627239047,
        10.704001049182839, 10.717581635913213, 10.730199633881007, 10.741824928694447, 10.752400349336721,
        10.76183768691201, 10.770199954855684, 10.777518766096401, 10.783800114717605,
        10.789000090744732, 10.79330003386672, 10.796781221388564, 10.799699933161406, 10.802331233938004,
        10.804700040501185, 10.806875008653277, 10.808999972471936, 10.811275005499555,
        10.813600045260483, 10.815975038588801, 10.818300016744887, 10.820481238621866, 10.822499969466849,
        10.824312487950268, 10.825900012079304, 10.827256263547364, 10.828300008036576,
        10.828918754232735, 10.829200000632296, 10.829137500666139, 10.82890000149907, 10.828537501297104,
        10.828399999572207, 10.828649998431738, 10.829899997688761, 10.83298125926752,
        10.8374, 10.84247481176551, 10.849599797974443, 10.859644362404321, 10.873501180444455, 10.891868858517212,
        10.916199162553223, 10.947137901252058, 10.987801613397307,
        11.040500563233637, 11.108299560218962, 11.195294620029074, 11.30070233651235, 11.425833620835107,
        11.568501342145268, 11.728079155917563, 11.901195582676046, 12.084737101847567,
        12.277303543165111, 12.476794260338602, 12.682197327310643, 12.89221297568728, 13.105604088296108,
        13.321019271606094, 13.537501613529102, 13.753995579108716, 13.969596589460812,
        14.183902028816686, 14.396301710943195, 14.60660304413771, 14.815202085983392, 15.022300865359306,
        15.229101961195955, 15.43689955149194, 15.648798857968181, 15.870501111953832,
        16.110201294121016, 16.376300821770897, 16.673599620998395, 17.006299196175366, 17.3825, 17.81672773105336,
        18.33088576853192, 19.046628608352666, 20.09418970490948,
        21.491230281088864, 23.36403554732082, 25.78376521823396, 28.688107928806346, 31.859201234384482,
        35.017082236799915, 37.95437646080889, 40.59985045611013, 42.98048210407093,
        45.1544184613274, 47.16911033788443, 49.052955010384366, 50.81965651115024, 52.47622896820607,
        54.02872289866365, 55.48438187378059, 56.8520614050832, 58.14146251402683,
        59.36252223933174, 60.524308447319974, 61.63472254490186, 62.70008343383558, 63.72517263243636,
        64.71280785221128, 65.66488300213246, 66.58250904660159, 67.466303629751,
        68.31728492887835, 69.13689827598066, 69.92729589043422, 70.69130364581491, 71.4320037480388, 72.1526020814846,
        72.8561991609682, 73.54488590248961, 74.2203, 74.88324012052786,
        75.53348459632291, 76.17032050101513, 76.79236111728054, 77.39811113614508, 77.98558255332685,
        78.55307191271253, 79.09881869347045, 79.62116841256307, 80.11909720281376,
        80.5914961419686, 81.03780872880081, 81.45769679012248, 81.85130336155706, 82.2188836409303, 82.56109186151474,
        82.8785848751381, 83.1724050992544, 83.44352077267085,
        83.69319692342157, 83.92260698691331, 84.13299398095259, 84.32556639998398, 84.50160125228153,
        84.66241852240712, 84.80909777955165, 84.94282414076376, 85.06460094063524,
        85.17548255405232, 85.27650096881764, 85.36869968841168, 85.45309854098299, 85.53062397909167,
        85.60259963171038, 85.67009303896315, 85.73479893180316, 85.7980431308708,
        85.8619999216585, 85.92846399908225, 85.9999, 86.07860508870539, 86.16729773859703, 86.26840352296135,
        86.38450929083348, 86.51800266808385, 86.6711950564598, 86.84609060310302,
        87.04440737024345, 87.2678098308423, 87.5176984811532, 87.79529755011251, 88.101506466041, 88.43719723218507,
        88.80320336842719, 89.19981118597049, 89.6272890703168,
        90.08551563972269, 90.5738090901216, 91.09117717933043, 91.63589283179887, 92.20581324930026, 92.79821148185921,
        93.40961158196752, 94.03640471213421, 94.67441331594091,
        95.31908974501125, 95.96600614539847, 96.6104051970725, 97.2481091983956, 97.8747062252834, 98.48636734911523,
        99.07970553088383, 99.651798798897, 100.19999716506996,
        100.723002467506, 101.21800247342479, 101.68600132623887, 102.12499948811279, 102.53499909813486, 102.918,
        103.27202083159587, 103.59999246212048, 103.90200943679265,
        104.18001990091277, 104.43500453334619, 104.66699331163939, 104.87898979530327, 105.07200645631241,
        105.24800695036602, 105.40699912885154, 105.5509862321857, 105.68100249933426,
        105.7989991161511, 105.90499310101568, 106.00000245218065, 106.08599798052656, 106.16400241159704,
        106.23300119546467, 106.29600090418226, 106.35199932091506, 106.40199862325085,
        106.44700082257413, 106.48799714828864, 106.52400025180003, 106.55599937952627, 106.58499849434241,
        106.6109993243235, 106.63500017410645, 106.65500028587994, 106.67400018249637,
        106.69100006278799, 106.70500013594169, 106.71899997143262, 106.73099994180055, 106.74100005011003,
        106.7510000444878, 106.75899970585455, 106.7669997052772, 106.7729999863407,
        106.78, 106.78500031563006, 106.78999988832835, 106.79400013564693, 106.79799976787382, 106.80100005596874,
        106.80399990941137, 106.80700020795435, 106.81000008164065,
        106.81199988652543, 106.81399998847277, 106.81599998600497, 106.8170000167957, 106.81799998947737,
        106.82000001178021, 106.82100002714502, 106.82199997532162, 106.82300003853845,
        106.82399992987605, 106.82400001269836, 106.82499998928847, 106.82499999515238, 106.82599997508082,
        106.82600001557186, 106.82700000124032, 106.82699999659057, 106.82799998678215,
        106.828, 106.82799999865053, 106.82800001211264, 106.82899995688712, 106.82900000902247, 106.829, 106.829,
        106.829, 106.82899999919178, 106.82900000427776, 106.83000000097483,
        106.83000000669797, 106.83, 106.83};

// Interpolation data for g_eff
static const std::vector<double> _data_sm_geffs{3.3839699989395835, 3.3840487437644517, 3.3842699903810276,
        3.384735624825629,
        3.3854900038512112, 3.3862912280687207, 3.3880999598306882, 3.3917099989920962, 3.3973800518739967,
        3.405183885849205, 3.4164701323918063, 3.4321248326801963, 3.453609551704515, 3.482146469649636,
        3.519339777655313, 3.56667197412332, 3.625730336042383, 3.6980913883908952,
        3.7852698853256537, 3.8888564215194035, 4.0102, 4.150794807316553, 4.311795892941468, 4.494954121810155,
        4.699976214930413, 4.927911218293275, 5.176482196900135, 5.444893579507091,
        5.729750258626947, 6.029061098885618, 6.337818201506156, 6.652822969680463, 6.9666562245634225,
        7.271231690587198, 7.565352533586669, 7.845235954042654, 8.110553641754548,
        8.359949946825193, 8.59272403967336, 8.807570499056927, 9.00494757517125, 9.18429186814512, 9.347362952209552,
        9.495029957384766, 9.629400961950292, 9.752973734862081,
        9.865448301893807, 9.967108712735158, 10.058700701881913, 10.14078523513029, 10.21420069474718,
        10.2795819076444, 10.338100529303755, 10.391075108886902, 10.438699761340171,
        10.481537438750442, 10.519800185143403, 10.553781350015388, 10.583799966065143, 10.610118744432556, 10.6332,
        10.65343721086418, 10.671299597352577, 10.687200386274478,
        10.701701071584862, 10.715606640925841, 10.728599621802584, 10.740662429708268, 10.751700366541062,
        10.761618946103374, 10.770399952742551, 10.777987514603408, 10.784400114885585,
        10.789543840025653, 10.793700032836007, 10.797049973942578, 10.79979993789156, 10.802181234797406,
        10.804300036285406, 10.806275005726231, 10.80829997290033, 10.810675008065274,
        10.813200049389502, 10.815812542296054, 10.818400018605427, 10.82083123701361, 10.8230999655015,
        10.825181236330375, 10.827000013496429, 10.828493764882047, 10.829600008371425,
        10.83021250346392, 10.830399998814471, 10.830106250382935, 10.829600002909952, 10.829000001894816,
        10.828699998716642, 10.828868747660579, 10.83029999725666, 10.834075011178859,
        10.8395, 10.845681023602184, 10.854299756293019, 10.86640072989741, 10.883001405083759, 10.904843878232874,
        10.93379900226057, 10.970500500305192, 11.019401960977774,
        11.083906919233751, 11.167799453551327, 11.27754482503736, 11.408502862062473, 11.559602804184298,
        11.726601524068334, 11.90507898935648, 12.094495202826907, 12.293349519026512,
        12.500103797163375, 12.713206829095649, 12.93119717296118, 13.152519220199826, 13.375904265336509,
        13.599899423093277, 13.823501659544904, 14.045595477169236, 14.265496532622665,
        14.482602050526342, 14.696801721875234, 14.908003048983103, 15.116602085146253, 15.323500863266368,
        15.529801958508713, 15.737699550277814, 15.950798846416452, 16.176101137251248,
        16.423301347251392, 16.70280087021931, 17.019999592881767, 17.379599126059833, 17.7909, 18.270631701571034,
        18.886282262611214, 19.810533868948983, 21.014403816051455,
        22.6405354400298, 24.837624307484827, 27.677842245112068, 31.059624742778315, 34.68787520006785,
        38.20338054032787, 41.35827519819795, 44.08965109338545, 46.459982467376946,
        48.56451768154225, 50.4770155788509, 52.240658134062045, 53.87705209265294, 55.39742647308172, 56.8108207705348,
        58.12718365397002, 59.35806532439285, 60.51556636614012,
        61.61151997509638, 62.65630760906369, 63.65852039676292, 64.62468493956084, 65.55887499903574,
        66.46320720601332, 67.33858434423519, 68.18490835611833, 69.00220335949038,
        69.79048602738794, 70.5509983988954, 71.28569617578638, 71.99760340213557, 72.69000351079194, 73.3664019579262,
        74.02969920721264, 74.68198661689348, 75.3246, 75.95773837641659,
        76.5804852316591, 77.19151967954201, 77.7886626799343, 78.36971067439409, 78.93218331877144, 79.47377324503925,
        79.99251772483608, 80.48647021574627, 80.95449737927565,
        81.39559641067538, 81.80920805965577, 82.19539706002443, 82.55430305264244, 82.88668527392075,
        83.19329274218097, 83.47515986863573, 83.73360446463396, 83.96989554534252,
        84.18549735561933, 84.38183905931078, 84.5602949171765, 84.72228550370983, 84.86910104011582, 85.00213108401348,
        85.12249818494024, 85.23144929178228, 85.33000075924294,
        85.41926354891706, 85.50020077443466, 85.57379975195202, 85.64109883606507, 85.70299918661287,
        85.76089970199104, 85.81587440276637, 85.86979909693483, 85.9241182235268,
        85.98119992864254, 86.04299897252092, 86.1122, 86.19130520069095, 86.28329762412618, 86.39070377964339,
        86.51631012470597, 86.66260293703776, 86.83179452602216, 87.02578955993744,
        87.2464081995925, 87.49491093540041, 87.7726983130649, 88.08059728588013, 88.41940714660666, 88.78989694991898,
        89.19250369915848, 89.62731224417233, 90.09438807988965,
        90.59311699253986, 91.12260983686882, 91.68127541057189, 92.26689231034163, 92.87691414475941,
        93.50771219649683, 94.15541223413081, 94.81550494706401, 95.4832138931542,
        96.15358937333521, 96.82140632176937, 97.48180530423376, 98.13000931202002, 98.76170624872508,
        99.37296751786185, 99.9605054543766, 100.52199882732157, 101.05399726242167,
        101.55700236082052, 102.02800233824621, 102.46800124142977, 102.87699952549443, 103.2549991740175, 103.603,
        103.92201865274248, 104.21399332758733, 104.48000823751889,
        104.72101716282664, 104.94000388661394, 105.13799432822954, 105.31599147646948, 105.4770053190239,
        105.62100569611079, 105.75099929117114, 105.8669889656256, 105.97100198200053,
        106.06399930686312, 106.14699461375038, 106.22100189569144, 106.28699846174712, 106.34600184999128,
        106.39900090036218, 106.44600067813667, 106.48799949229294, 106.52499898682889,
        106.55800060343306, 106.5879979226772, 106.61400018729906, 106.63799953634835, 106.65899893235168,
        106.67699953292117, 106.69400012956741, 106.70900020108502, 106.72200012724518,
        106.73400004534686, 106.74400008852021, 106.75299998107411, 106.76199995590956, 106.76900003556192,
        106.77600002823267, 106.78099980816616, 106.78699977895873, 106.79099999165261,
        106.795, 106.79900026472362, 106.80299992023633, 106.80500009223833, 106.80799982062926, 106.81000005596869,
        106.81299992451235, 106.81400010944914, 106.81600007581007,
        106.8179998968443, 106.81899999519676, 106.81999999160291, 106.82100002015498, 106.82199999210815,
        106.8230000088352, 106.82400003166985, 106.82499998354879, 106.82500002752529,
        106.82599991234072, 106.82600001269836, 106.82699998928847, 106.82700000484743, 106.82699999003177,
        106.8280000062294, 106.828, 106.828, 106.82799999471271, 106.82900000316936,
        106.829, 106.829, 106.829, 106.829, 106.829, 106.82899998195742, 106.82999999559071, 106.83, 106.83, 106.83,
        106.83, 106.83, 106.83};

// Cubic-splines for Sqrt[g_star], h_eff and g_eff
static const boost::math::cubic_b_spline<double> _sqrt_gstar_spline{_data_sm_sqrt_gstars.begin(),
        _data_sm_sqrt_gstars.end(),
        _sm_log_temperature_min, _sm_log_temperature_step};

static const boost::math::cubic_b_spline<double> _heff_spline{_data_sm_heffs.begin(), _data_sm_heffs.end(),
        _sm_log_temperature_min, _sm_log_temperature_step};

static const boost::math::cubic_b_spline<double> _geff_spline{_data_sm_geffs.begin(), _data_sm_geffs.end(),
        _sm_log_temperature_min, _sm_log_temperature_step};


/**
 * Compute the effective number of degrees of freedom in energy of the SM.
 * @param T Temperature of the SM bath.
 * @return g_eff.
 */
double sm_dof_energy(double T) {
    double log_T = log10(T);
    if (log_T < _sm_log_temperature_min) {
        return _data_sm_geffs.front();
    } else if (log_T > _sm_log_temperature_max) {
        return _data_sm_geffs.back();
    }
    return _geff_spline(log_T);
}

/**
 * Compute the effective number of degrees of freedom in entropy of the SM.
 * @param T Temperature of the SM bath.
 * @return h_eff.
 */
double sm_dof_entropy(double T) {
    double log_T = log10(T);
    if (log_T < _sm_log_temperature_min) {
        return _data_sm_heffs.front();
    } else if (log_T > _sm_log_temperature_max) {
        return _data_sm_heffs.back();
    }
    return _heff_spline(log_T);
}

/**
 * Compute the value of h_eff / sqrt(g_eff) * (1 + (T / 3 h_eff) * dh_eff / dT)
 * @param Temperature of the SM bath.
 * @return Square-root of g_star.
 */
double sm_sqrt_gstar(double T) {
    double log_T = log10(T);
    if (log_T < _sm_log_temperature_min) {
        return _data_sm_sqrt_gstars.front();
    } else if (log_T > _sm_log_temperature_max) {
        return _data_sm_sqrt_gstars.back();
    }
    return _sqrt_gstar_spline(log_T);
}

/**
 * Compute the energy density of the SM bath.
 * @param T Temperature of the SM bath.
 * @return Energy density.
 */
double sm_energy_density(double T) {
    return M_PI * M_PI / 30.0 * sm_dof_energy(T) * T * T * T * T;
}

/**
 * Compute the entropy density of the SM bath.
 * @param T Temperature of the SM bath.
 * @return Entropy density.
 */
double sm_entropy_density(double T) {
    return 2.0 * M_PI * M_PI / 45.0 * sm_dof_entropy(T) * T * T * T;
}

}